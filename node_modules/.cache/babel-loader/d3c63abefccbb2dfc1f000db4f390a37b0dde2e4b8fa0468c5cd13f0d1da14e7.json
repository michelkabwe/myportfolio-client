{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState,useRef}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const CategoriesContext=/*#__PURE__*/createContext(undefined);export const useCategoriesContext=()=>{const context=useContext(CategoriesContext);if(!context){throw new Error('useCategoriesContext must be used within a CategoriesProvider');}return context;};export const CategoriesProvider=_ref=>{let{children}=_ref;const[posts,setPosts]=useState([]);const handlePostClick=id=>{return\"https://myportfolio-backend-ten.vercel.app/api/posts/\".concat(id);};const fetchPosts=async()=>{try{const response=await axios.get('https://myportfolio-backend-ten.vercel.app/api/posts/');setPosts(response.data);}catch(error){console.error('Error fetching data:',error);}};useEffect(()=>{fetchPosts();},[]);const[selectedFile,setSelectedFile]=useState(null);const handleFileChange=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){setSelectedFile(file);}};const titleRef=useRef(null);const contentRef=useRef(null);const selectRef=useRef(null);const liveUrlRef=useRef(null);const sourceCodeRef=useRef(null);const handleSubmitPost=async event=>{event.preventDefault();try{var _titleRef$current,_contentRef$current,_selectRef$current,_liveUrlRef$current,_sourceCodeRef$curren;const formData=new FormData();if(selectedFile){formData.append('file',selectedFile);;}const response=await axios.post('https://myportfolio-backend-ten.vercel.app/api/upload',formData,{headers:{'Content-Type':'multipart/form-data'}});const title=((_titleRef$current=titleRef.current)===null||_titleRef$current===void 0?void 0:_titleRef$current.value)||'';const content=((_contentRef$current=contentRef.current)===null||_contentRef$current===void 0?void 0:_contentRef$current.value)||'';const selectedCategory=((_selectRef$current=selectRef.current)===null||_selectRef$current===void 0?void 0:_selectRef$current.value)||'';const liveUrl=((_liveUrlRef$current=liveUrlRef.current)===null||_liveUrlRef$current===void 0?void 0:_liveUrlRef$current.value)||'';const sourceCode=((_sourceCodeRef$curren=sourceCodeRef.current)===null||_sourceCodeRef$curren===void 0?void 0:_sourceCodeRef$curren.value)||'';const imageUrl=response.data.imageUrl;formData.append('title',title);formData.append('content',content);formData.append('selectedCategory',selectedCategory);formData.append('imageUrl',imageUrl);formData.append('liveUrl',liveUrl);formData.append('sourceCode',sourceCode);const res=await axios.post('https://myportfolio-backend-ten.vercel.app/api/posts/',{title,content,selectedCategory,imageUrl,liveUrl,sourceCode});}catch(error){console.error('Error',error);}};const handleUpdatePost=async(id,updatedData)=>{try{const response=await axios.put(\"https://myportfolio-backend-ten.vercel.app/api/posts/\".concat(id),updatedData);setPosts(prevPosts=>prevPosts.map(post=>post.id===id?{...post,...updatedData}:post));return response;}catch(error){console.error('Error updating post:',error);throw error;}};const handleDeletePost=async id=>{try{await axios.delete(\"https://myportfolio-backend-ten.vercel.app/api/posts/\".concat(id));const updatedPosts=posts.filter(post=>post.id!==id);setPosts(updatedPosts);}catch(error){console.error('Error deleting post:',error);}};const contextValue={posts,handleDeletePost,handlePostClick,handleUpdatePost,handleSubmitPost,handleFileChange,titleRef,contentRef,selectRef,liveUrlRef,sourceCodeRef};return/*#__PURE__*/_jsx(CategoriesContext.Provider,{value:contextValue,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useRef","axios","jsx","_jsx","CategoriesContext","undefined","useCategoriesContext","context","Error","CategoriesProvider","_ref","children","posts","setPosts","handlePostClick","id","concat","fetchPosts","response","get","data","error","console","selectedFile","setSelectedFile","handleFileChange","event","_event$target$files","file","target","files","titleRef","contentRef","selectRef","liveUrlRef","sourceCodeRef","handleSubmitPost","preventDefault","_titleRef$current","_contentRef$current","_selectRef$current","_liveUrlRef$current","_sourceCodeRef$curren","formData","FormData","append","post","headers","title","current","value","content","selectedCategory","liveUrl","sourceCode","imageUrl","res","handleUpdatePost","updatedData","put","prevPosts","map","handleDeletePost","delete","updatedPosts","filter","contextValue","Provider"],"sources":["/Users/Michelka/Documents/portfolio/frontend/src/contexts/usePostProvider/usePostList.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, ReactNode, useRef } from 'react';\nimport axios from 'axios';\n\n\ninterface CategoriesProviderProps {\n    children: ReactNode;\n}\n\ninterface Category {\n    id: number;\n    category_id: string;\n    content: string;\n    title: string;\n    imageUrl: string;\n    urlsRef:string;\n    liveUrl:string;\n    sourceCode:string;\n}\n\ninterface ContextValue {\n    posts: Category[];\n    handleDeletePost: (id: number) => void;\n    handlePostClick: (id: number) => void;\n    handleUpdatePost: (id: number, updatedData: Partial<Category>) => void;\n    handleSubmitPost: (event: React.FormEvent<HTMLFormElement>) => Promise<void>;\n    handleFileChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n    titleRef: React.MutableRefObject<HTMLInputElement | null>;\n    contentRef: React.MutableRefObject<HTMLTextAreaElement | null>;\n    selectRef: React.MutableRefObject<HTMLSelectElement | null>;\n    liveUrlRef: React.MutableRefObject<HTMLInputElement | null>;\n    sourceCodeRef:React.MutableRefObject<HTMLInputElement | null>;\n}\n\n\n\nconst CategoriesContext = createContext<ContextValue | undefined>(undefined);\n\nexport const useCategoriesContext = (): ContextValue => {\n    const context = useContext(CategoriesContext);\n    if (!context) {\n        throw new Error('useCategoriesContext must be used within a CategoriesProvider');\n    }\n    return context;\n};\n\nexport const CategoriesProvider: React.FC<CategoriesProviderProps> = ({ children }) => {\n    const [posts, setPosts] = useState<Category[]>([]);\n\n    const handlePostClick = (id: number) => {\n        return `https://myportfolio-backend-ten.vercel.app/api/posts/${id}`\n    };\n\n    const fetchPosts = async () => {\n        try {\n            const response = await axios.get<Category[]>('https://myportfolio-backend-ten.vercel.app/api/posts/');\n            setPosts(response.data);\n        } catch (error) {\n            console.error('Error fetching data:', error);\n        }\n    };\n\n\n\n    useEffect(() => {\n        fetchPosts();\n    }, []);\n\n\n    const [selectedFile, setSelectedFile] = useState<File | null>(null);\n\n    const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const file = event.target.files?.[0];\n        if (file) {\n            setSelectedFile(file);\n        }\n    };\n\n    const titleRef = useRef<HTMLInputElement>(null);\n    const contentRef = useRef<HTMLTextAreaElement>(null);\n    const selectRef = useRef<HTMLSelectElement>(null);\n    const liveUrlRef = useRef<HTMLInputElement>(null);\n    const sourceCodeRef = useRef<HTMLInputElement>(null);\n\n\n\n    const handleSubmitPost = async (event: React.FormEvent<HTMLFormElement>) => {\n        event.preventDefault();\n\n\n        try {\n            const formData = new FormData();\n            if (selectedFile) {\n                formData.append('file', selectedFile);\n                ;\n            }\n\n            const response: any = await axios.post('https://myportfolio-backend-ten.vercel.app/api/upload', formData, {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n\n            });\n\n            const title = titleRef.current?.value || '';\n            const content = contentRef.current?.value || '';\n            const selectedCategory = selectRef.current?.value || '';\n            const liveUrl = liveUrlRef.current?.value || '';\n            const sourceCode = sourceCodeRef.current?.value ||'';\n\n            const imageUrl = response.data.imageUrl;\n\n            formData.append('title', title);\n            formData.append('content', content);\n            formData.append('selectedCategory', selectedCategory);\n            formData.append('imageUrl', imageUrl);\n            formData.append('liveUrl', liveUrl);\n            formData.append('sourceCode', sourceCode);\n\n\n            const res = await axios.post<FormData>('https://myportfolio-backend-ten.vercel.app/api/posts/', {\n                title, content, selectedCategory, imageUrl, liveUrl, sourceCode\n\n            })\n\n        } catch (error) {\n            console.error('Error', error)\n        }\n    }\n\n\n\n    const handleUpdatePost = async (id: number, updatedData: Partial<Category>) => {\n        try {\n            const response = await axios.put(`https://myportfolio-backend-ten.vercel.app/api/posts/${id}`, updatedData);\n            setPosts(prevPosts =>\n                prevPosts.map(post => (post.id === id ? { ...post, ...updatedData } : post))\n            );\n\n            return response;\n        } catch (error) {\n            console.error('Error updating post:', error);\n            throw error;\n        }\n    };\n\n\n    const handleDeletePost = async (id: number) => {\n        try {\n            await axios.delete(`https://myportfolio-backend-ten.vercel.app/api/posts/${id}`);\n            const updatedPosts = posts.filter(post => post.id !== id);\n            setPosts(updatedPosts);\n        } catch (error) {\n            console.error('Error deleting post:', error);\n        }\n    };\n\n    const contextValue: ContextValue = {\n        posts,\n        handleDeletePost,\n        handlePostClick,\n        handleUpdatePost,\n        handleSubmitPost,\n        handleFileChange,\n        titleRef,\n        contentRef,\n        selectRef,\n        liveUrlRef,\n        sourceCodeRef\n    };\n\n    return (\n        <CategoriesContext.Provider value={contextValue}>\n            {children}\n        </CategoriesContext.Provider>\n    );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}